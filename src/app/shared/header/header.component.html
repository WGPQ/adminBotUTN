<!-- Topbar Start -->
<div class="navbar-custom">
  <ul class="list-unstyled topbar-menu float-end mb-0">
    <!-- <li class="dropdown notification-list d-lg-none">
      <a
        class="nav-link dropdown-toggle arrow-none mt-2"
        data-bs-toggle="dropdown"
        href="#"
        role="button"
        aria-haspopup="false"
        aria-expanded="false"
      >
        <i class="mdi mdi-account-tie-voice mdi-24px"></i>
      </a>
      <div class="dropdown-menu dropdown-menu-animated dropdown-lg p-0">
        <div class="dropdown-header noti-title">
          <h5 class="text-overflow mb-2">
            <span class="text-danger">{{ usuariosOnline.length }}</span>
            Agentes en linea
            <a (click)="refrescar()">
              <small class="float-end">
                <i class="mdi mdi-refresh mdi-24px"></i></small
            ></a>
          </h5>
        </div>
        <div class="notification-list">
          <a
            *ngFor="let user of usuariosOnline"
            class="dropdown-item notify-item"
          >
            <div class="notify-icon bg-primary">
              <i class="mdi mdi-comment-account-outline"></i>
            </div>
            <p class="notify-details">
              {{ user.nombre_completo }}
              <small class="text-muted">{{
                user.conectedAt | date : "dd/MM/yyyy hh:mm a"
              }}</small>
            </p>
          </a>
        </div>
      </div>
    </li> -->

    <li class="dropdown notification-list">
      <a
        class="nav-link dropdown-toggle arrow-none"
        data-bs-toggle="dropdown"
        href="#"
        role="button"
        aria-haspopup="false"
        aria-expanded="false"
      >
        <i class="dripicons-bell noti-icon"></i>
        <span
          *ngIf="
            (solicitudes?.length ?? 0 > 0) && mostrarNotificacionesSolicitudes
          "
          class="noti-icon-badge"
        ></span>
      </a>
      <div
        class="dropdown-menu dropdown-menu-end dropdown-menu-animated dropdown-lg"
      >
        <!-- item-->
        <div class="dropdown-item noti-title">
          <h5 class="m-0"><span class="float-end"> </span>Solicitudes</h5>
        </div>

        <div style="max-height: 230px" data-simplebar="">
          <!-- item-->
          <div *ngIf="mostrarNotificacionesSolicitudes">
            <a
              *ngFor="let solicitud of solicitudes"
              class="dropdown-item notify-item"
              routerLink="/dashboard/chat"
            >
              <div class="notify-icon">
                <!-- <i class="mdi mdi-comment-account-outline"></i> -->
                <span class="account-user-avatar">
                  <div
                    class="circleHeader"
                    [ngStyle]="{ 'background-color': solicitud?.color }"
                  >
                    <div class="initialsHeader">
                      {{ initialsName(solicitud.name!) }}
                    </div>
                  </div>
                </span>
              </div>

              <p class="notify-details">
                {{ solicitud.name }}
                <small class="text-muted">{{
                  solicitud?.timestamp | timeAgo
                }}</small>
              </p>
            </a>
          </div>
        </div>

        <!-- All-->
        <!-- <a
          href="javascript:void(0);"
          class="dropdown-item text-center text-primary notify-item notify-all"
        >
          View All
        </a> -->
      </div>
    </li>

    <li class="dropdown notification-list">
      <a
        class="nav-link dropdown-toggle nav-user arrow-none me-0"
        data-bs-toggle="dropdown"
        href="#"
        role="button"
        aria-haspopup="false"
        aria-expanded="false"
      >
        <span class="account-user-avatar">
          <img
            *ngIf="usuario.foto?.trim()?.length! > 0"
            [src]="usuario.foto"
            [alt]="usuario.nombres"
            class="circleHeader"
          />
          <div
            *ngIf="usuario.foto?.trim()?.length === 0 || usuario.foto == null"
            class="circleHeader"
            [ngStyle]="{ 'background-color': '#0DA1E6' }"
          >
            <div class="initialsHeader">
              {{ initialsName(usuario.nombre_completo!) }}
            </div>
          </div>
        </span>

        <span>
          <span class="account-user-name">{{ usuario.nombre_completo }}</span>
          <span class="account-position">{{ usuario.rol }}</span>
        </span>
      </a>
      <div
        class="dropdown-menu dropdown-menu-end dropdown-menu-animated topbar-dropdown-menu profile-dropdown"
      >
        <!-- item-->
        <a routerLink="/dashboard/perfil" class="dropdown-item notify-item">
          <i class="mdi mdi-account-circle me-1"></i>
          <span>Perfil</span>
        </a>

        <!-- item-->
        <a class="dropdown-item notify-item" (click)="logout()">
          <i class="mdi mdi-logout me-1"></i>
          <span>Salir</span>
        </a>
      </div>
    </li>
  </ul>
  <button class="button-menu-mobile open-left">
    <i class="mdi mdi-menu"></i>
  </button>

  <div
    *ngIf="mostrarUsuariosEnLinea"
    class="app-search dropdown d-none d-lg-block"
  >
    <form>
      <div class="input-group">
        <span class="mdi mdi-account-tie-voice search-icon"></span>
        <input
          type="submit"
          class="form-control dropdown-toggle"
          value="Agentes en lÃ­nea"
          id="top-search"
        />
        <div class="input-group-text btn-success">
          {{ usuariosOnline.length }}
        </div>
      </div>
    </form>

    <div
      class="dropdown-menu dropdown-menu-animated dropdown-lg"
      id="search-dropdown"
    >
      <!-- item-->
      <div class="dropdown-header noti-title">
        <h5 class="text-overflow mb-2">
          <span class="text-danger">{{ usuariosOnline.length }}</span>
          Agentes en linea
          <a (click)="refrescar()">
            <small class="float-end">
              <i class="mdi mdi-refresh mdi-24px"></i></small
          ></a>
        </h5>
      </div>

      <div class="notification-list">
        <a
          *ngFor="let user of usuariosOnline"
          class="dropdown-item notify-item"
        >
          <div class="notify-icon bg-primary">
            <i class="mdi mdi-comment-account-outline"></i>
          </div>
          <p class="notify-details">
            {{ user.nombre_completo }}
            <small class="text-muted">{{
              user.conectedAt | date : "dd/MM/yyyy hh:mm a"
            }}</small>
          </p>
        </a>
        <!-- All-->
      </div>
    </div>
  </div>
</div>
<!-- end Topbar -->
